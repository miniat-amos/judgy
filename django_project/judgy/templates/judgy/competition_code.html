{% extends 'judgy/base_competition.html' %}

{% block title %}{{ competition.name }}{% endblock %}

{% block main_competition %}

<div class="container py-5">
  <ul class="nav nav-tabs d-flex justify-content-center" role="tablist">
    <li class="nav-item" role="presentation">
      <button
        id="problems-tab"
        class="nav-link active"
        style="width: 8rem"
        data-bs-target="#problems-tab-pane"
        data-bs-toggle="tab"
        role="tab"
        type="button"
      >
        Problems
      </button>
    </li>
    <li class="nav-item" role="presentation">
      <button
        id="rankings-tab"
        class="nav-link"
        style="width: 8rem"
        data-bs-target="#rankings-tab-pane"
        data-bs-toggle="tab"
        role="tab"
        type="button"
      >
        Rankings
      </button>
    </li>
  </ul>
  <div class="py-5 tab-content">
    <div id="problems-tab-pane" class="tab-pane fade show active" role="tabpanel">
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">Name</th>
              <th scope="col">Download</th>
              <th scope="col">Submit</th>
              <th scope="col">Best Score</th>
    
            </tr>
          </thead>
          <tbody class="table-group-divider">
            {% for problem in problems %}
              <tr>
                <th scope="row">{{ problem.number }}</th>
                <td>
                    {{ problem.name }}
                </td>
                <td> <a href="{% url 'judgy:download' competition.code problem.name  %}" download="">Download Zip</a></td>
                <td>
                  <form id="code-submit" method="POST" enctype="multipart/form-data" action="{% url 'judgy:submit' competition.code problem.name %}">
                    {% csrf_token %}
                    <!-- {{ form.file }} -->
                    <input type="file" name="file" multiple>
                    <input type="submit" value="Upload" style="margin-top: 10px;" />
                  </form>
                </td>
                <td>{{ problem.best_score  }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    <div id="rankings-tab-pane" class="tab-pane fade" role="tabpanel">
      <div class="table-responsive">
        <table class="table table-hover">
          <thead>
            <tr>
              <th scope="col">#</th>
              <th scope="col">Team</th>
            </tr>
          </thead>
          <tbody class="table-group-divider">
            {% for team in teams %}
              <tr>
                <th scope="row">{{ forloop.counter }}</th>
                <td>
                  <a class="text-decoration-none" href="{% url 'judgy:team_name' competition.code team.name %}">
                    {{ team.name }}
                  </a>
                </td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
  {% if user.is_superuser %}
    <div class="text-center">
      <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#manage-problems">Manage Problems</button>
    </div>
  {% endif %}
</div>

{% include 'judgy/includes/manage_problems.html' %}

{% endblock %}
